@page "/servers"
@rendermode InteractiveServer
@inject NavigationManager NavigationManager

<h3>Servers</h3>
<br />
<br />
<CityListComponent @ref="cityListComponent" SelectCityCallBack="HandleCitySelection"></CityListComponent>
<br />

<SearchBarComponent @ref="searchBarComponent" SearchServerCallback="HandleSearchServer"
					style="width:1000px"
					data-my-attribute="my data">
</SearchBarComponent>

<br />

<CascadingValue Name="SelectedCity" Value="@selectedCity">
	<ServerListComponent @rendermode="InteractiveServer"
						 CityName="@this.selectedCity"
						 SearchFilter="@this.searchFilter">
	</ServerListComponent>
</CascadingValue>
<p>
	<a href="/servers/add" class="btn btn-primary">Add Server</a>
</p>

@code {

	private string selectedCity = "Tronto";
	private string searchFilter = "";

	private CityListComponent? cityListComponent;
	private SearchBarComponent? searchBarComponent;

	private void HandleSearch(MouseEventArgs args)
	{
		//servers = ServersRepository.SearchServers(serverFilter);
		//this.selectedCity = string.Empty;
	}
	private void HandleCitySelection(string cityName)
	{
		selectedCity = cityName;
		this.searchFilter = "";
		searchBarComponent?.ClearFilter();
	}
	private void HandleSearchServer(string searchFilter)
	{
		this.searchFilter = searchFilter;

		cityListComponent?.ClearSelection();
	}
}
